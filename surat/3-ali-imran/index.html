<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Quran</title>

<link id="canonicalLink" rel="canonical" href="">
<meta name="description" content="Baca Al-Qur'an lengkap dengan teks Arab, terjemah Indonesia, dan murottal audio.">
<meta name="robots" content="index, follow">
<meta name="theme-color" content="#2e7d32">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
<link rel="stylesheet" href="../../css/base.css">
<link rel="stylesheet" href="../../css/surat.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/plyr@3/dist/plyr.css">
</head>

<body>

<header id="header-js">
<a href="/" class="back-btn">
  <svg width="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <polyline points="15 18 9 12 15 6"/>
  </svg> 
</a>
<button class="toggle" onclick="toggleDark()">ðŸŒ™</button>
<h1>
  <img src="https://lh3.googleusercontent.com/d/1-Ufwu2QXVkDiVmHp0wr0tq4GUVUrEpH-=w100"
       width="100"
       height="43"
       alt="Al-Quranul Karim"
       loading="eager"
       decoding="async">
</h1>
</header>

<div class="top-container">
  <h2 id="titleLatin"></h2>
  <div id="titleArab" class="arab-title"></div>
  <div id="titleArti"></div>
  <div id="info" class="info"></div>
</div>

<div class="container">

<div class="navcon">
  <div class="nav">
    <button onclick="go(-1)"></button>
    <button onclick="go(1)"></button>
  </div>
</div>

<div class="surat-select-wrap">
  <select id="suratSelect"></select>
</div>

<div id="bismillah" class="bismillah"></div>
<div id="content"></div>

<script>
/* ==========================
   QURAN SIGN SPLITTER + HIZB
========================== */

const WAQAF_SET = new Set(['\u06D6','\u06D7','\u06D8','\u06D9','\u06DA','\u06DB','\u06DC']);
const RUB_SIGN = '\u06DE';
const NUN_WIQOYAH = '\u06E7';
const IQLAB_MIM = '\u06E2';
const IGNORE_SET = new Set(['\u06DF']);
const QURAN_SCAN_REGEX = /([\u06D6-\u06ED])/g;

function splitQuranSigns(root = document) {
  root.querySelectorAll('.ayah-text').forEach(el => {
    if (el.dataset.signSplit) return;

    el.innerHTML = el.innerHTML.replace(QURAN_SCAN_REGEX, ch => {
      if (IGNORE_SET.has(ch)) return ch;
      if (ch === NUN_WIQOYAH) return `<span class="nun-wiqoyah">${ch}</span>`;
      if (ch === IQLAB_MIM) return `<span class="iqlab-mim">${ch}</span>`;
      if (ch === RUB_SIGN) return `<span class="rub-wrap"><span class="rub-sign">${ch}</span></span>`;
      if (WAQAF_SET.has(ch)) return `<span class="waqaf">${ch}</span>`;
      return ch;
    });

    el.dataset.signSplit = '1';
  });
}

function applyHizbLabels() {
  document.querySelectorAll('.rub-wrap').forEach((rub, i) => {
    const r = (i + 1) % 4;
    rub.dataset.hizbLabel =
      r === 1 ? 'Â¼ Ø­Ø²Ø¨' :
      r === 2 ? 'Â½ Ø­Ø²Ø¨' :
      r === 3 ? 'Â¾ Ø­Ø²Ø¨' : 'Ø­Ø²Ø¨';
  });
}

function injectStyles() {
  if (document.getElementById('quran-hizb-style')) return;
  const s = document.createElement('style');
  s.id = 'quran-hizb-style';
  s.textContent = `
    .rub-wrap{position:relative;display:inline-block;margin-inline-start:.1em}
    .rub-wrap::after{
      content:attr(data-hizb-label);
      position:absolute;
      left:50%;
      transform:translateX(-50%) translateY(-.9em);
      font-size:.45em;
      white-space:nowrap;
      line-height:1
    }`;
  document.head.appendChild(s);
}

const observer = new MutationObserver(m => {
  m.forEach(x => x.addedNodes.forEach(n => {
    if (n.nodeType !== 1) return;
    splitQuranSigns(n);
    applyHizbLabels();
  }));
});

observer.observe(document.body,{childList:true,subtree:true});
splitQuranSigns(); applyHizbLabels(); injectStyles();
</script>

<div class="nav" id="navBottom">
  <button onclick="go(-1)"></button>
  <button onclick="go(1)"></button>
</div>

<div class="footer">
  <span>Â© <span id="year"></span></span>
  <a href="https://kangis.my.id" target="_blank">Kang Ismet</a> â€¢ Smart Media
</div>

</div>

<div class="player-wrap" id="playerWrap">
  <button class="close" onclick="closePlayer()" aria-label="Tutup player">
    <svg viewBox="0 0 24 24" width="20" height="20">
      <line x1="6" y1="6" x2="18" y2="18"/>
      <line x1="18" y1="6" x2="6" y2="18"/>
    </svg>
  </button>
  <audio id="player"></audio>
</div>

<button class="top" onclick="scrollToTop()">
  <svg viewBox="0 0 24 24"><path d="M6 15l6-6 6 6"></path></svg>
</button>
<script>
  window.SURAT_ID = 3;
</script>
<script src="https://cdn.jsdelivr.net/npm/plyr@3/dist/plyr.polyfilled.js"></script>
<script src="../../js/theme.js"></script>
<script src="../../js/surat.js"></script>
<script src="../../js/dropdown.js"></script>
<script src="../../js/headerhide.js"></script>
</body>
</html>
